################################################################################
# Project Name : Variables affecting Sales of commercial district              # 
# Project type : Regression Analysis                                           #
# Date         : 2018/04/07                                                    #
# By           : Team Ev??                                                      #
################################################################################


# 1. ??™£?ê¶ï§?€ ?ê½•ç§»? (Install and call library for necessary packages) ----

install.packages("readxl")
install.packages("writexl")
install.packages("dplyr")
install.packages("data.table")
install.packages("car")
install.packages("gvlma")
install.packages("lm.beta")
install.packages("lmtest")
install.packages("magrittr")
install.packages("tidyverse")
library(readxl)
library(writexl)
library(dplyr)
library(data.table)
library(car)
library(gvlma)
library(lm.beta)
library(lmtest)
library(magrittr)
library(tidyverse)

# 2. ?ëµ??? †??„—?”±? ?ê½??? ™ (Set Directory) ----
setwd(dir = "C:/Users/eljuw/Desktop/Team EVE/")
getwd()


# 3. ??œ²??” ?ê½? ?º?ˆ?œ­??‚¤æ¹?? (Read Data) ----

# ï§¡ë©¸?€? : ??œ²??” ?ê½???’— ?ê½???Š±??–† ?€¨ë“¦?‚¬??œ²??” ?ê½£ç‘œ? ?ê¶???Šœ
#        ?ê½???Š±??–†?ë¿´ç”±ê³•ëœ²??” ?ê½£æ„¿ë¬’ì˜£??“½ ?ê½???Š±??–† ?€¨â‘¤?‰?ê¸½æ²…? ?ë´½æ¿¡?’—?™†??”ª ?? ™è¹‚ëŒ?“½ ?ê¸½æ²…?š­?‚µ ?ê¸½æ²…?š®ê°???‘ï§Â€??“½ ??œ²??” ?ê½??ë±???“£ ??” ??Šœ
#        ??œ²??” ?ê½???’— 2015??€ˆéº?€?ê½? 2018??€? 1??¡æºëš¯??€ è­°ëŒ?˜±?ë¸???–
#        RStudio?ë¿??ê½? encoding ??‚¤?‘œ?„?? è«›â‘¹??€?ë¸?æ¹?? ???ë¹? ï§â‘¤ë±? ??™†??”ªï§ë‚†?“£ ??º?ë¼±æ¿¡? ??‹”?? ™?ë¸?æ¹?? ???ë¹?
#        ?ê¸½æ²…?š¯?“½ ?ë¿???œ‘??’— Commercial_ æ¿??, è«›ê³ ?‘ï§Â€ ?ë¿???œ‘??’— Hinter_æ¿?? ?ê½??? ™
#        ?ë¸???™†??“ƒ = N_Aparts, ï§ë¬ì»???–†?ê½? = N_Facs, ?? ?ë£???‹” = N_Store,
#        ???€?ë£???”¤?´? = F_Pop, ?ê¸½äºŒ?‡±?”¤?´? = S_Pop, ï§ê³¸?˜£??”¤?´? = W_Pop, ?•°ë¶¿ì ™ï§ã…¼?…§ = Sales, ??ƒ¼?ë±???ƒ¼?®? = Income_Spend
#
# 
# äºŒì‡±ê½?
# ?ê¸½æ²…? : Commercial District, ?ê¸½æ²…?š®ê°???‘ï§Â€ : Hinterland, ?ë¸???™†??“ƒ : Number of Aparments, 
# ï§ë¬ì»???–†?ê½? : Number of Gathering Facilities ???€?ë£???”¤?´? = Floating Population, ?ê¸½äºŒ?‡±?”¤?´? : Settled Population
# ï§ê³¸?˜£??”¤?´? : Working Population, ?•°ë¶¿ì ™ï§ã…¼?…§ : Estimated Sales, ??ƒ¼?ë±?/??ƒ¼?®? : Income and Spend

# ?ê¸½æ²…? ????œ²??” ?ê½? ?º?ˆ?œ­??‚¤æ¹??

C_Sales         <- read_excel(path = "Commercial_Sales.xlsx", sheet = 1, col_names = TRUE)
C_N_Aparts      <- read_excel(path = "Commercial_N_Aparts.xlsx", sheet = 1, col_names = TRUE)
C_N_Facs        <- read_excel(path = "Commercial_N_Facs.xlsx", sheet = 1, col_names = TRUE)
C_N_Store       <- read_excel(path = "Commercial_N_Store.xlsx", sheet = 1, col_names = TRUE)
C_Income_Spend  <- read_excel(path = "Commercial_Income_Spend.xlsx", sheet = 1, col_names = TRUE)
C_F_Pop         <- read_excel(path = "Commercial_F_Pop.xlsx", sheet = 1, col_names = TRUE)
C_S_Pop         <- read_excel(path = "Commercial_S_Pop.xlsx", sheet = 1, col_names = TRUE)
C_W_Pop         <- read_excel(path = "Commercial_W_Pop.xlsx", sheet = 1, col_names = TRUE)

# è«›ê³ ?‘ï§Â€ ????œ²??” ?ê½? ?º?ˆ?œ­??‚¤æ¹??

H_N_Aparts      <- read_excel(path = "Hinter_N_Aparts.xlsx", sheet = 1, col_names = TRUE)
H_N_Facs        <- read_excel(path = "Hinter_N_Facs.xlsx", sheet = 1, col_names = TRUE)
H_N_Store       <- read_excel(path = "Hinter_N_Store.xlsx", sheet = 1, col_names = TRUE)
H_Income_Spend  <- read_excel(path = "Hinter_Income_Spend.xlsx", sheet = 1, col_names = TRUE)
H_F_Pop         <- read_excel(path = "Hinter_F_Pop.xlsx", sheet = 1, col_names = TRUE)
H_S_Pop         <- read_excel(path = "Hinter_S_Pop.xlsx", sheet = 1, col_names = TRUE)
H_W_Pop         <- read_excel(path = "Hinter_W_Pop.xlsx", sheet = 1, col_names = TRUE)

# ??™†??”ª??”  ?? £???€æ¿¡ì’•ë§? ??‚??–‡??‘æ¿?? ?ë§‚å¯ƒê»‹ì“£ ??†—??”¤?ë¸?æ¹?? ???ë¸??ë¿? Structure?‘œ? ??†—??”¤
str(C_Sales) 
# tbl_df ??‚??–‡??‘æ¿?? ??œ²??” ?ê½? ?ë´??? …??—«??‘æ¿?? ?º?ˆ?œ­ï§ê¾§ì¾???“£ ??†—??”¤


# 4. ??œ²??” ?ê½? ??Ÿ¾ï§£ì„?” (Preproecessing of Data) ----

# ?º?ˆ?œ­??‚© ??œ²??” ?ê½??ë±????€ Raw Dataæ¿¡ì’–?œ¥ ??–?? £ ?ê¶???Šœ?ë¸? ??œ²??” ?ê½£åª›?€ ?ë¸???•¶å¯ƒê»Šë±???”  ï§ë¡ªë¦??ë¸£è‡¾ëª„ë¿‰ ??Ÿ¾ï§£ì„?”?‘œ? ??„»?ë¹??ê½? ?ë¸???Š‚?ë¸? ??œ²??” ?ê½??ë±¾ï§? ?ê¶???Šœ?ë¸???–

# 4-1. ?ë¸???Š‚?ë¸? ?ë¿´ï§? ??œ²??” ?ê½£æ¿¡? ???€??˜£?ë¸?æ¹??(?ê¸½æ²…?) ----

# åª›ê³´ì»? ??œ²??” ?ê½? ?ë´??? …??—«?ë¿??ê½? ?ê¶???Šœ?ë¸? ??œ²??” ?ê½£ï§? ?•°ë¶¿í…§?ë¸???–
# ?ê¶???Šœ?ë¸? ??œ²??” ?ê½???’— 2018??€? 1??¡ ??œ²??” ?ê½???—«??‘æ¿?? ï§â‘¤ë±? ??œ²??” ?ê½??ë¿??ê½? 2018??€? 1??¡ ??œ²??” ?ê½£ç‘œ? ?•°ë¶¿í…§?ë¸??€??
# ?•°ë¶¿í…§?ë¸???‘ ??œ²??” ?ê½£ç‘œ? è¹‚ë?€?’— æ¹²ê³—??€??”¤ ?ê¸½æ²…?š¯?«?ë±¶ç‘œ? ??‚¤?‘œ?Œê°???‹š??‘æ¿?? ?? ™?? ¹?ë¸???–

# ï§ã…¼?…§
C_Sales <- C_Sales [C_Sales$æ¹²ê³—??€_??€???¡_?‚„ë¶¾ë±¶ == 201801, c(2, 12)]
C_Sales <- C_Sales [order(C_Sales$?ê¸½æ²…?_?‚„ë¶¾ë±¶, decreasing = FALSE), ]

# ?ë¸???™†??“ƒ
C_N_Aparts <- C_N_Aparts [C_N_Aparts$æ¹²ê³—??€_??€???¡_?‚„ë¶¾ë±¶ == 201801, c(2, 4)]
C_N_Aparts <- C_N_Aparts [order(C_N_Aparts$?ê¸½æ²…?_?‚„ë¶¾ë±¶, decreasing = FALSE), ]

# ï§ë¬ì»???–†?ê½?
C_N_Facs <- C_N_Facs [C_N_Facs$æ¹²ê³—??€_??€???¡_?‚„ë¶¾ë±¶ == 201801, c(2, 4)]
C_N_Facs <- C_N_Facs [order(C_N_Facs$?ê¸½æ²…?_?‚„ë¶¾ë±¶, decreasing = FALSE), ]

# ?? ?ë£?
C_N_Store <- C_N_Store [C_N_Store$æ¹²ê³—??€_??€???¡_?‚„ë¶¾ë±¶ == 201801, c(2, 6)]
C_N_Store <- C_N_Store [order(C_N_Store$?ê¸½æ²…?_?‚„ë¶¾ë±¶, decreasing = FALSE), ]

# ??ƒ¼?ë±?/??ƒ¼?®?
C_Income_Spend <- C_Income_Spend [C_Income_Spend$æ¹²ê³—??€_??€???¡_?‚„ë¶¾ë±¶ == 201801, c(2, 4, 6)]
C_Income_Spend <- C_Income_Spend [order(C_Income_Spend$?ê¸½æ²…?_?‚„ë¶¾ë±¶, decreasing = FALSE), ]

# ???€?ë£???”¤?´?
C_F_Pop <- C_F_Pop [C_F_Pop$æ¹²ê³—??€_??€???¡_?‚„ë¶¾ë±¶ == 201801, c(2, 4)]
C_F_Pop <- C_F_Pop [order(C_F_Pop$?ê¸½æ²…?_?‚„ë¶¾ë±¶, decreasing = FALSE), ]

# ?ê¸½äºŒ?‡±?”¤?´?
C_S_Pop <- C_S_Pop [C_S_Pop$`æ¹²ê³—??€??€???¡ ?‚„ë¶¾ë±¶` == 201801, c(2, 4)]
C_S_Pop <- C_S_Pop [order(C_S_Pop$`?ê¸½æ²…? ?‚„ë¶¾ë±¶`, decreasing = FALSE), ]
colnames(C_S_Pop) <- c("?ê¸½æ²…?_?‚„ë¶¾ë±¶", "?¥?_?ê¸½äºŒ?‡±?”¤?´?_??‹”")
# ?ê¸½æ²…?š¯?“½ ?ê¸½äºŒ?‡±?”¤?´? ??œ²??” ?ê½? ??™†??”ª??”  è¹‚Â€??‹”??” ?”±? ?ê¶???” ?ë¿? _åª›Â€ ?ë¾¾æ¹²ê³•ë¸£?‡¾ëª„ë¿‰ ??„»??”ª??–†?ê¶æ¹²? ???ë¹? colnames?‘œ? è¹‚Â€å¯??

# ï§ê³¸?˜£??”¤?´?
C_W_Pop <- C_W_Pop [C_W_Pop$æ¹²ê³—??€_??€???¡_?‚„ë¶¾ë±¶ == 201801, c(2, 4)]
C_W_Pop <- C_W_Pop [order(C_W_Pop$?ê¸½æ²…?_?‚„ë¶¾ë±¶, decreasing = FALSE), ]


# C_Sales (ï§ã…¼?…§)???€ ??œ²??” ?ê½£åª›?€ åª›ê³´ë¦? ?ê½Œé®ê¾©ë’ª?ë¾½é†«?‚…?€æ¿¡? ?êµ???‹ ?ì¡???—³æ¹?? ?ë¸£è‡¾ëª„ë¿‰ ?ê¸½æ²…?š¯?«?ë±¶è¹‚ê¾¨ì¤ˆ ?ºê¾¨ìªŸ?ë¸?æ¹?? ???ë¹??ê½?
# aggregate function??“£ ??” ??Šœ?ë¸??ë¿? ?ê¸½æ²…?š¯?«?ë±¶è¹‚ê¾¨ì¤ˆ ?ë¹€??“£ ?´?‹ë¸³??–
# sum ??“£ ?ë¸??? ®ï§?? numeric ??” ?ë¿? ?ë¸???‘æ¿?? ??Š¦?ê½???Ÿ»??‘æ¿?? ??–¦??¡_ï§ã…¼?…§_æ¹²ë‰ë¸???“£ numeric ??‚?ê¹?æ¿?? è¹‚Â€??‚?ë¸???–
C_Sales$??–¦??¡_ï§ã…¼?…§_æ¹²ë‰ë¸? <- as.numeric(C_Sales$??–¦??¡_ï§ã…¼?…§_æ¹²ë‰ë¸?)
C_Sales <- aggregate(C_Sales$??–¦??¡_ï§ã…¼?…§_æ¹²ë‰ë¸?, by=list(Code=C_Sales$?ê¸½æ²…?_?‚„ë¶¾ë±¶), FUN=sum)
colnames(C_Sales) <- c("?ê¸½æ²…?_?‚„ë¶¾ë±¶", "??–¦??¡_ï§ã…¼?…§_æ¹²ë‰ë¸?")

# C_N_Store (?ê¸½æ²…?š¯?“½ ?? ?ë£???“½ ??‹”)?ë£? C_Sales ï§£ì„?† ?ê½Œé®ê¾©ë’ª?ë¾½é†«?‚…?€æ¿¡? ?êµ???‹ ?ì¡???—³?ë¼??ê½? åª›ìˆˆ??€ process?‘œ? è«›ì„?‚¬?ë¸??ë¿? ?ë¹€??“£ ?´?‹ë¸³??–
C_N_Store$?? ?ë£?_??‹” <- as.numeric(C_N_Store$?? ?ë£?_??‹”)
C_N_Store <- aggregate(C_N_Store$?? ?ë£?_??‹”, by=list(Code=C_N_Store$?ê¸½æ²…?_?‚„ë¶¾ë±¶), FUN=sum)
colnames(C_N_Store) <- c("?ê¸½æ²…?_?‚„ë¶¾ë±¶", "?? ?ë£?_??‹”")

# ï§â‘¤ëª? ??œ²??” ?ê½??ë´??? …??—«??‘æ¿?? ??–??–† ???€??˜£
C_N_Aparts     <- as.data.frame(C_N_Aparts)
C_N_Facs       <- as.data.frame(C_N_Facs)
C_N_Store      <- as.data.frame(C_N_Store)
C_Income_Spend <- as.data.frame(C_Income_Spend)
C_F_Pop        <- as.data.frame(C_F_Pop)
C_S_Pop        <- as.data.frame(C_S_Pop)
C_W_Pop        <- as.data.frame(C_W_Pop)


# 4.2. ?ë¸???Š‚?ë¸? ?ë¿´ï§? ??œ²??” ?ê½£æ¿¡? ???€??˜£?ë¸?æ¹??(è«›ê³ ?‘ï§Â€) ----

# ?ë¸???™†??“ƒ
H_N_Aparts <- H_N_Aparts [H_N_Aparts$`æ¹²ê³—??€??€???¡ ?‚„ë¶¾ë±¶` == 201801, c(2, 4)]
H_N_Aparts <- H_N_Aparts [order(H_N_Aparts$`?ê¸½æ²…? ?‚„ë¶¾ë±¶`, decreasing = FALSE), ]
colnames(H_N_Aparts) <- c("?ê¸½æ²…?_?‚„ë¶¾ë±¶", "?ë¸???™†??“ƒ_??–’ï§Â€_??‹”")
# ?ê¸½æ²…?š®ê°???‘ï§Â€ ?ë¸???™†??“ƒ??“½ ??œ²??” ?ê½? ??™†??”ª??”  è¹‚Â€??‹”??” ?”±? ?ê¶???” ?ë¿? _åª›Â€ ?ë¾¾æ¹²ê³•ë¸£?‡¾ëª„ë¿‰ ??„»??”ª??–†?ê¶æ¹²? ???ë¹? colnames?‘œ? è¹‚Â€å¯??

# ï§ë¬ì»???–†?ê½?
H_N_Facs <- H_N_Facs [H_N_Facs$æ¹²ê³—??€_??€???¡_?‚„ë¶¾ë±¶ == 201801, c(2, 4)]
H_N_Facs <- H_N_Facs [order(H_N_Facs$?ê¸½æ²…?_?‚„ë¶¾ë±¶, decreasing = FALSE), ]

# ?? ?ë£?
H_N_Store <- H_N_Store [H_N_Store$`æ¹²ê³—??€ ??€???¡ ?‚„ë¶¾ë±¶` == 201801, c(2, 5)]
H_N_Store <- H_N_Store [order(H_N_Store$`?ê¸½æ²…? ?‚„ë¶¾ë±¶`, decreasing = FALSE), ]
colnames(H_N_Store) <- c("?ê¸½æ²…?_?‚„ë¶¾ë±¶", "?? ?ë£?_??‹”")
# ?ê¸½æ²…?š®ê°???‘ï§Â€ ??ƒ¼?ë±???ƒ¼?®ê¾©ì“½ ??œ²??” ?ê½? ??™†??”ª??”  è¹‚Â€??‹”??” ?”±? ?ê¶???” ?ë¿? _åª›Â€ ?ë¾¾æ¹²ê³•ë¸£?‡¾ëª„ë¿‰ ??„»??”ª??–†?ê¶æ¹²? ???ë¹? colnames?‘œ? è¹‚Â€å¯??

# ??ƒ¼?ë±?/??ƒ¼?®?
H_Income_Spend <- H_Income_Spend [H_Income_Spend$æ¹²ê³—??€??€???¡?‚„ë¶¾ë±¶ == 201801, c(2, 4, 6)]
H_Income_Spend <- H_Income_Spend [order(H_Income_Spend$?ê¸½æ²…?š¯?«?ë±?, decreasing = FALSE), ]
colnames(H_Income_Spend) <- c("?ê¸½æ²…?_?‚„ë¶¾ë±¶", "??¡?ë£Šæ´¹ì¢ëƒ¼?ë±?_æ¹²ë‰ë¸?", "ï§Â€?•°?_?¥?•·?ˆ‘?ë¸?")
# ?ê¸½æ²…?š®ê°???‘ï§Â€ ??ƒ¼?ë±???ƒ¼?®ê¾©ì“½ ??œ²??” ?ê½? ??™†??”ª??”  è¹‚Â€??‹”??” ?”±? ?ê¶???” ?ë¿? _åª›Â€ ?ë¾¾æ¹²ê³•ë¸£?‡¾ëª„ë¿‰ ??„»??”ª??–†?ê¶æ¹²? ???ë¹? colnames?‘œ? è¹‚Â€å¯??

# ???€?ë£???”¤?´?
H_F_Pop <- H_F_Pop [H_F_Pop$æ¹²ê³—??€_??€???¡_?‚„ë¶¾ë±¶ == 201801, c(2, 3)]
H_F_Pop <- H_F_Pop [order(H_F_Pop$?ê¸½æ²…?_?‚„ë¶¾ë±¶, decreasing = FALSE), ]

# ?ê¸½äºŒ?‡±?”¤?´?
H_S_Pop <- H_S_Pop [H_S_Pop$`æ¹²ê³—??€??€???¡ ?‚„ë¶¾ë±¶` == 201801, c(2, 3)]
H_S_Pop <- H_S_Pop [order(H_S_Pop$`?ê¸½æ²…? ?‚„ë¶¾ë±¶`, decreasing = FALSE), ]
colnames(H_S_Pop) <- c("?ê¸½æ²…?_?‚„ë¶¾ë±¶", "?¥?_?ê¸½äºŒ?‡±?”¤?´?_??‹”")
# ?ê¸½æ²…?š®ê°???‘ï§Â€ ?ê¸½äºŒ?‡±?”¤?´?Šì“½ ??œ²??” ?ê½? ??™†??”ª??”  è¹‚Â€??‹”??” ?”±? ?ê¶???” ?ë¿? _åª›Â€ ?ë¾¾æ¹²ê³•ë¸£?‡¾ëª„ë¿‰ ??„»??”ª??–†?ê¶æ¹²? ???ë¹? colnames?‘œ? è¹‚Â€å¯??

# ï§ê³¸?˜£??”¤?´?
H_W_Pop <- H_W_Pop [H_W_Pop$æ¹²ê³—??€_??€???¡_?‚„ë¶¾ë±¶ == 201801, c(2,4)]
H_W_Pop <- H_W_Pop [order(H_W_Pop$?ê¸½æ²…?_?‚„ë¶¾ë±¶, decreasing = FALSE), ]


# H_N_Store (?ê¸½æ²…?š®ê°???‘ï§Â€??“½ ?? ?ë£???“½ ??‹”)?ë£? C_Sales ï§£ì„?† ?ê½Œé®ê¾©ë’ª?ë¾½é†«?‚…?€æ¿¡? ?êµ???‹ ?ì¡???—³?ë¼??ê½? åª›ìˆˆ??€ process?‘œ? è«›ì„?‚¬?ë¸??ë¿? ?ë¹€??“£ ?´?‹ë¸³??–
H_N_Store$?? ?ë£?_??‹” <- as.numeric(H_N_Store$?? ?ë£?_??‹”)
H_N_Store <- aggregate(H_N_Store$?? ?ë£?_??‹”, by=list(Code=H_N_Store$?ê¸½æ²…?_?‚„ë¶¾ë±¶), FUN=sum)
colnames(H_N_Store) <- c("?ê¸½æ²…?_?‚„ë¶¾ë±¶", "?? ?ë£?_??‹”")

# ï§â‘¤ëª? ??œ²??” ?ê½??ë´??? …??—«??‘æ¿?? ??–??–† ???€??˜£
H_N_Aparts     <- as.data.frame(H_N_Aparts)
H_N_Facs       <- as.data.frame(H_N_Facs)
H_N_Store      <- as.data.frame(H_N_Store)
H_Income_Spend <- as.data.frame(H_Income_Spend)
H_F_Pop        <- as.data.frame(H_F_Pop)
H_S_Pop        <- as.data.frame(H_S_Pop)
H_W_Pop        <- as.data.frame(H_W_Pop)


# 4-3. ??œ²??” ?ê½? ?ë¹€ç§»ì„ë¦? (Merging Data) ----

# åª?? ??œ²??” ?ê½??ë±???“£ ?ê¸½æ²…?š­?‚µ ?ê¸½æ²…?š®ê°???‘ï§Â€æ¿?? åª›ê³´ì»? ?ë¹€?ˆ¾ë¨?ê½? ??œ²??” ?ê½£ç‘œ? ?ëª¢åª›?’•ì¤? ï§ëš®ë±???–
# ??” è¸?? ?ë´½æ¿¡?’–? ¥??“ƒ?ë¿??ê½???’— ?†«?‚†?ƒ½è¹‚Â€??‹”åª›Â€ ?ê¸½æ²…?š¯?“½ ï§ã…¼?…§ C_Sales ??—«??‘æ¿?? ??” ?‘œ? æ¹²ê³—??€??‘æ¿?? ??˜Ÿ??’—??–
# ï§â‘¤ë±? è¹‚Â€??‹”?ë±????€ ?ê¸½æ²…?_?‚„ë¶¾ë±¶æ¿?? ?ºê¾¨ìªŸåª›Â€ ?ë¦??ë¼???—³æ¹?? ?ë¸£è‡¾ëª„ë¿‰ ??” ?‘œ? ??” ??Šœ?ë¸??ë¿? ??œ²??” ?ê½£ç‘œ? ??„»?ë¹€?ë¸???–
# C_Sales?ë¿???’— 1744åª›ì’–?“½ ?ê¸½æ²…?_?‚„ë¶¾ë±¶åª›Â€ è­°ëŒ?˜±?ë¸???– æ´¹ëªƒ?†??‘æ¿?? 1?º?€?ê½? 1744æºëš¯??€??“½ ??œ²??” ?ê½? ?ë´??? …??—«??“£ ?ê¹??ê½???‘ ??” ?ë¿? ï§ìš?– ?ê½? ?ë¹€ç§»ì’•?–


Total_Commercial <- data.frame('?ê¸½æ²…?_?‚„ë¶¾ë±¶' = c(1:1744))
View(Total_Commercial)

Total_Commercial <- merge(Total_Commercial, C_Sales,
                          by = "?ê¸½æ²…?_?‚„ë¶¾ë±¶", all = TRUE)

Total_Commercial <- merge(Total_Commercial, C_N_Aparts,
                          by = "?ê¸½æ²…?_?‚„ë¶¾ë±¶", all = TRUE)

Total_Commercial <- merge(Total_Commercial, C_N_Facs,
                          by = "?ê¸½æ²…?_?‚„ë¶¾ë±¶", all = TRUE)

Total_Commercial <- merge(Total_Commercial, C_N_Store,
                          by = "?ê¸½æ²…?_?‚„ë¶¾ë±¶", all = TRUE)

Total_Commercial <- merge(Total_Commercial, C_Income_Spend,
                          by = "?ê¸½æ²…?_?‚„ë¶¾ë±¶", all = TRUE)

Total_Commercial <- merge(Total_Commercial, C_F_Pop,
                          by = "?ê¸½æ²…?_?‚„ë¶¾ë±¶", all = TRUE)

Total_Commercial <- merge(Total_Commercial, C_S_Pop,
                          by = "?ê¸½æ²…?_?‚„ë¶¾ë±¶", all = TRUE)

Total_Commercial <- merge(Total_Commercial, C_W_Pop,
                          by = "?ê¸½æ²…?_?‚„ë¶¾ë±¶", all = TRUE)

View(Total_Commercial)


# ?ê¸½æ²…?š®ê°???‘ï§Â€ (Hinterland)??“½ ??œ²??” ?ê½? merge

Total_Hinter <- data.frame("?ê¸½æ²…?_?‚„ë¶¾ë±¶" = c(1:1744))
View(Total_Hinter)

Total_Hinter <- merge(Total_Hinter, H_N_Aparts,
                      by = "?ê¸½æ²…?_?‚„ë¶¾ë±¶", all = TRUE)

Total_Hinter <- merge(Total_Hinter, H_N_Facs,
                      by = "?ê¸½æ²…?_?‚„ë¶¾ë±¶", all = TRUE)

Total_Hinter <- merge(Total_Hinter, H_N_Store,
                      by = "?ê¸½æ²…?_?‚„ë¶¾ë±¶", all = TRUE)

Total_Hinter <- merge(Total_Hinter, H_Income_Spend,
                      by = "?ê¸½æ²…?_?‚„ë¶¾ë±¶", all = TRUE)

Total_Hinter <- merge(Total_Hinter, H_F_Pop,
                      by = "?ê¸½æ²…?_?‚„ë¶¾ë±¶", all = TRUE)

Total_Hinter <- merge(Total_Hinter, H_S_Pop,
                      by = "?ê¸½æ²…?_?‚„ë¶¾ë±¶", all = TRUE)

Total_Hinter <- merge(Total_Hinter, H_W_Pop,
                      by = "?ê¸½æ²…?_?‚„ë¶¾ë±¶", all = TRUE)

View(Total_Hinter)



# 4-4. å¯ƒê³—ë¥«ç§»? ?? £å«?? è«?? ??œ²??” ?ê½? ?? ™?”±? ----

# ?ëª? ??™†??”ª ï§â‘¤ëª? C_Sales??“½ ?ê¸½æ²…?š¯?«?ë±¶ç‘œ? æ¹²ê³—??€??‘æ¿?? ?ë¹€?ˆ¾ë¨?ì£±ï§?€ï§?? ï§â‘¤ë±? è¹‚Â€??‹”?ë±???”  ?ê¸½æ²…?š®?€æ¿¡? è­°ê³—ê¶??ë§‚å¯ƒê»‹ì”  ?ë¸???•²?ë¼??ê½? å¯ƒê³—ë¥«ç§»?„??€ è­°ëŒ?˜±?ë¸?
# ??”  å¯ƒê³—ë¥«ç§»?„?? åª›Â€ï§Â€?€?? ?ºê¾©ê½??“£ ?ë¸???–ï§?? ?‡¾ëª„ì £åª›Â€ ?ê¹?æ¹?? ?ë¿¬ï§?€åª›Â€ ??—³??“¬ 
# ??” ??œ´ å¯ƒê³—ë¥«ç§»?„??€ ??—³??’— ?ê¸½æ²…?š¯??€ ??œ²??” ?ê½? ?ºê¾©ê½?ë¿??ê½? ?? £??‡…?ë¸???’—å¯ƒê»‹?”  ?êµ???“£å¯ƒê»‹?‘æ¿?? ??™‹??–’?ë¸??ë¿? ?? £??‡…

Total_Commercial <- na.omit(Total_Commercial)
Total_Hinter     <- na.omit(Total_Hinter)

# ?? ª?”±?Šê½¦?€?? ??„»??”ª?ê½???“£ ???ë¸??ë¿? ï§â‘¤ë±? colnames?‘œ? ??º?ë¼±æ¿¡? è¹‚Â€å¯??
colnames(Total_Commercial) 
colnames(Total_Hinter)
#?ê¸½æ²…?_?‚„ë¶¾ë±¶, ?ë¸???™†??“ƒ_??–’ï§Â€_??‹”, ï§ë¬ì»???–†?ê½?_??‹”, ?? ?ë£?_??‹”, ??¡_?ë£Šæ´¹?_??ƒ¼?ë±?_æ¹²ë‰ë¸?, ï§Â€?•°?_?¥?•·?ˆ‘?ë¸?, ?¥?_???€?ë£???”¤?´?_??‹”, ?¥?_?ê¸½äºŒ?‡±?”¤?´?_??‹”, ?¥?_ï§ê³¸?˜£??”¤?´?_??‹”

colnames(Total_Commercial) <- c("Code", "Sales", "C_N_Aparts", "C_N_Facs", "C_Store", "C_Income", 
                                "C_Spend", "C_F_Pop", "C_S_Pop", "C_W_Pop")
colnames(Total_Hinter) <- c("Code", "H_N_Aparts", "H_N_Facs", "H_Store", "H_Income", "H_Spend", 
                                "H_F_Pop", "H_S_Pop", "H_W_Pop")

# ?ë¿????€æ¿?? ???€??˜£
writexl::write_xlsx(Total_Commercial, path = "Total_Commercial.xlsx")
writexl::write_xlsx(Total_Hinter, path = "Total_Hinter.xlsx")


# 4-5. ï§â‘¤ë±? ??œ²??” ?ê½? ?ë¹€ç§»ì„ë¦? ----

# ?ê¸½æ²…?š­?‚µ ?ê¸½æ²…?š®ê°???‘ï§Â€??“½ ï§â‘¤ë±? ??œ²??” ?ê½£ç‘œ? ?ë¹€ç§»ì’•?–
All_Total <- merge(Total_Commercial, Total_Hinter,
                 by = "Code", all = TRUE)
View(All_Total)

# ?ë¹€ç§»ì’—?‘?ë¿??ë£? å¯ƒê³—ë¥«ç§»?„??€ è­°ëŒ?˜±?ë¸???‘æ¿?? å¯ƒê³—ë¥«ç§»?„?? ?ë¾??ë¸???–

All_Total <- na.omit(All_Total)
# å¯ƒê³—ë¥«ç§»?„?? ï§â‘¤ëª? ?? £å«„ê³ ë¸?ï§?? ?¥? 1050åª›ì’–?“½ ??œ²??” ?ê½£åª›?€ è­°ëŒ?˜±


# ?ëª¢åª›? ?ë¹€?ˆ¾ë¨?ì­? ??œ²??” ?ê½? ?ë¿????€æ¿?? ???€??˜£?ë¸?æ¹?? 

writexl::write_xlsx(All_Total, path = "All_Total.xlsx")

# 4-6. ?ë¸???Š‚?ë¾???’— Data ï§ë¶¾?ˆ?”±?Šë¿‰?ê½? ?ê¶??? £

# ??” ?? £ ?ë¸???Š‚?ë¸? Data??’— All_Total ?ë¸??êµ? ?‚‰ë¨??—«??‘æ¿?? ï§ë¶¾?ˆ?”±???? ï§¡â‘¥??€?ë¸???’— ??–?‘œ? ??œ²??” ?ê½£ç‘œ? ?? £å«„ê³ ë¸??ë¿?
# ?†«?€??œ‘ ????†¢??†š ??†šå¯ƒìŒ?“£ ï§ëš®ë±??ë¼±ä»¥?€?ê½?
rm(list=(ls()[ls()!="All_Total"]))

# 5. ??–ä»¥ë¬“?‰¶æ´¹Â€?ºê¾©ê½ 

# 5.1 Model_1 :?ê¸½æ²…?š¯?“½ ï§ã…¼?…§??“£ ?†«?‚†?ƒ½è¹‚Â€??‹”æ¿¡ì’—ë¸??ë¿? ?ê¸½æ²…? ??ƒŠ???€ è«›ê³ ?‘ï§Â€??“½ ?ë£†ç”±?ˆ??€??‹”?ë±? åª›ê¾©?“½ ??–ä»¥ë¬“?‰¶æ´¹Â€?ºê¾©ê½ ----

# 5.1.1 è¹‚Â€??‹”?ê½??ê¹? ?€¨ì‡±? ™ ----

All_Total <- readxl::read_excel(path = "All_Total.xlsx",
                                sheet = 1,
                                col_names = TRUE)

# Linear Model test?‘œ? ?ë¸?æ¹?? ???ë¹? ï§â‘¤ë±? è¹‚Â€??‹”?ë±???“£ Numeric??‘æ¿?? è¹‚Â€å¯??

All_Total <- mutate_all(All_Total, function(x) as.numeric(x))  

str(All_Total) #ï§â‘¤ëª? Numeric??”¤å¯ƒê»‹?“£ ??†—??€?

lm.result.all      <- lm(Sales ~ . - Code, data = All_Total)??”¤ #Code??’— ?ë£†ç”±?ˆ??€??‹”åª›Â€ ?ë¸???–‚??‘æ¿?? ?®ê¾§íƒ³?ë¸?ï§Â€ ?ë¸???“¬
lm.result.forward  <- step(lm.result.all, direction = "forward")
lm.result.backward <- step(lm.result.all, direction = "backward")
lm.result.stepwise <- step(lm.result.all, direction = "both")

# ?ë¼??ë¼? è«›â‘¹?–‡??“£ ?ê¶???Šœ?ë¸·ï§?€?‘œ? ?? ™?ë¸?æ¹?? ???ë¹??ê½? Akaike Information Criterion(AIC)??‘æ¿?? ??†—??”¤?ë¸???–

AIC(lm.result.all)
# 47439.57
AIC(lm.result.forward)
# 47439.57
AIC(lm.result.backward)
# 47428.46
AIC(lm.result.stepwise)
# 47428.46

# stepwise???€ backward è«›â‘¹?–‡??“½ AICåª›Â€ 42428.46??‘æ¿?? all???€ forward??“½ 47439.57 è¹‚ë?€?– ?ê¶???“¬??‘æ¿?? 
# stepwise è«›â‘¹?–‡??“£ ï§?ê¾ªê¹®

lm.result.final <- lm.result.stepwise
options(scipen = 100) # ?ëª???–†è«›â‘¸ì¾???“£ ??ƒ¼??‹”?? ??‘æ¿??

# 5.1.2 ï§â‘¤?œ½ ?ë¹??ê½? ----

summary(lm.result.final)

# Call:
#   lm(formula = Sales ~ C_N_Facs + C_Store + C_Income + C_S_Pop + 
#        C_W_Pop + H_N_Aparts, data = All_Total)
# 
# Residuals:
#   Min           1Q            Median      3Q         Max 
# -12592705690   -328945293    -46453784    242223784  35168692254 
# 
#               Estimate      Std. Error    t value      Pr(>|t|)
# (Intercept)  -476539347.5   209888641.0  -2.270        0.0234 * 
# C_N_Facs      15083184.2    2533015.0     5.955        0.00000000356 ***
# C_Store       10647321.9    1107249.4     9.616      < 0.0000000000000002 ***
# C_Income      132.7         63.8          2.079        0.0378 *  
# C_S_Pop      -174967.6      43067.0      -4.063        0.00005214868 ***
# C_W_Pop       726001.4      42269.8       17.175     < 0.0000000000000002 ***
# H_N_Aparts    381951.9      212449.2      1.798        0.0725 .  
# ---
# Signif. codes:  0 ??€?***??€? 0.001 ??€?**??€? 0.01 ??€?*??€? 0.05 ??€?.??€? 0.1 ??€? ??€? 1
# 
# Residual standard error: 1550000000 on 1043 degrees of freedom
# Multiple R-squared:  0.4934,	Adjusted R-squared:  0.4905 
# F-statistic: 169.3 on 6 and 1043 DF,  p-value: < 0.00000000000000022


  
# 1??–’?€?? : ??‰¶æ´¹Â€ï§â‘¦?‚???€ ???€??–¦?ë¸³åª›?€?
# æ´¹Â€?‡¾?‹¿??€?ê½? : ??‰¶æ´¹Â€ï§â‘¦?‚???€ ???€??–¦?ë¸?ï§Â€ ?ë¸???–
# ???€?”±?„??€?ê½? : ??‰¶æ´¹Â€ï§â‘¦?‚???€ ???€??–¦?ë¸???–
# F-statistic: 169.3 on 6 and 1043 DF,  p-value: < 0.00000000000000022
# å¯ƒê³•ì¤? : ???€??“½??†—?‘œì¢ì”  0.000 ??” èª˜Â€æ¿?? ???€??“½??‹”ä»¥Â€ 0.05è¹‚ë?€?– ?ê¶???“¬??‘æ¿?? ???€?”±?„??€?ê½???“£ ï§Â€ï§Â€?ë¸???–
# æ´¹ëªƒ?†??‘æ¿?? ??‰¶æ´¹Â€ï§â‘¦?‚???€ ??„»?€¨ê¾©?Ÿ»??‘æ¿?? ???€??–¦?ë¸???–.

# 2??–’?€?? : ?ë£†ç”±?ˆ??€??‹”?ë±????€ ?†«?‚†?ƒ½è¹‚Â€??‹”?ë¿‰å¯ƒ? ??º?ë¼???“£ äºŒì‡°?’—åª›Â€?
#               Estimate      Std. Error    t value      Pr(>|t|)    
# C_N_Facs      15083184.2    2533015.0     5.955        0.00000000356 ***
# C_Store       10647321.9    1107249.4     9.616      < 0.0000000000000002 ***
# C_Income      132.7         63.8          2.079        0.0378 *  
# C_S_Pop      -174967.6      43067.0      -4.063        0.00005214868 ***
# C_W_Pop       726001.4      42269.8       17.175     < 0.0000000000000002 ***
# H_N_Aparts    381951.9      212449.2      1.798        0.0725 .  
# ---
# Signif. codes:  0 ??€?***??€? 0.001 ??€?**??€? 0.01 ??€?*??€? 0.05 ??€?.??€? 0.1 ??€? ??€? 1  

# å¯ƒê³•ì¤? : C_Income, H_N_Aparts ??’— ???€??“½??‹”ä»¥Â€ 0.05?ë¿??ê½? ?†«?‚†?ƒ½è¹‚Â€??‹”?ë¿‰å¯ƒ? ??„»?€¨ê¾©?Ÿ»??‘æ¿?? ???€??“½?ë¸? ??º?ë¼???”  ?ë¾???“¬.



# ??„»?€¨ê¾©?Ÿ»??‘æ¿?? ?‡¾?Œ?“½èª˜ëª…ë¸? è¹‚Â€??‹” ?ëª¢åª›?’•?? ?? £??‡…?ë¸??€?? ï§â‘¤?œ½??“£ ??˜±?´?Šê½¦?ë¸?.


lm.result.final2 <- lm(Sales ~ C_N_Facs + C_Store + C_S_Pop + C_W_Pop, data = All_Total)
summary(lm.result.final2)

# 1??–’?€?? : ??‰¶æ´¹Â€ï§â‘¦?‚???€ ???€??–¦?ë¸³åª›?€?
# F-statistic: 250.9 on 4 and 1045 DF,  p-value: < 0.00000000000000022
# å¯ƒê³•ì¤? : ???€??“½??†—?‘œì¢ì”  0.000 ??” èª˜Â€æ¿?? ???€??“½??‹”ä»¥Â€ 0.05è¹‚ë?€?– ?ê¶???“¬??‘æ¿?? ???€?”±?„??€?ê½???“£ ï§Â€ï§Â€?ë¸???–
# æ´¹ëªƒ?†??‘æ¿?? ??‰¶æ´¹Â€ï§â‘¦?‚???€ ??„»?€¨ê¾©?Ÿ»??‘æ¿?? ???€??–¦?ë¸???–.

# 2??–’?€?? : ?ë£†ç”±?ˆ??€??‹”?ë±???”  ?†«?‚†?ƒ½è¹‚Â€??‹”?ë¿‰å¯ƒ? ??º?ë¼???“£ äºŒì‡°?’—åª›Â€?
#             Estimate    Std. Error  t value      Pr(>|t|)    
# C_N_Facs    14995676    2538850     5.906        0.00000000472 ***
# C_Store     10706604    1108389     9.660      < 0.0000000000000002 ***
# C_S_Pop    -142190      36170      -3.931        0.00009012138 ***
# C_W_Pop     738800      41209       17.928     < 0.0000000000000002 ***
# ---
# Signif. codes:  0 ??€?***??€? 0.001 ??€?**??€? 0.01 ??€?*??€? 0.05 ??€?.??€? 0.1 ??€? ??€? 1

# å¯ƒê³•ì¤? : C_N_Facs   (t = 5.906,  p < 0.001)
#        C_Store    (t = 9.660,  p < 0.001)
#        C_S_Pop    (t = -3.931, p < 0.001)
#        C_W_Pop    (t = 17.928, p < 0.001)
# ?ë£†ç”±?ˆ??€??‹” 4åª?? ï§â‘¤ëª¢åª›?€ ?†«?‚†?ƒ½è¹‚Â€??‹”?ë¿‰å¯ƒ? ???€??“½??‹”ä»¥Â€ 0.05?ë¿??ê½? ??„»?€¨ê¾©?Ÿ»??‘æ¿?? ???€??“½?ë¸? ??º?ë¼???“£ äºŒì‡°?’— å¯ƒê»‹?‘æ¿?? ?êµ????€?ê¶???–.

# 3??–’?€?? : ?ë£†ç”±?ˆ??€??‹”?ë±????€ ?ë¼??ë¼? ??º?ë¼???“£ äºŒì‡°?’—åª›Â€?
#             Estimate    
# C_N_Facs    14995676    
# C_Store     10706604    
# C_S_Pop    -142190     
# C_W_Pop     738800      

# C_N_Facs??’— ??–?‘œ? ?ê½? åª›ì’–?“½ ?ë£†ç”±?ˆ??€??‹” (C_Store, C_S_Pop, C_W_Pop)åª›Â€ ?€¨ì¢? ™?ë¦??ë¼???—³??“£ ?ë¸??ë¿?, C_N_Facs??“½ æ¹²ê³•?‚¯??–’??åª›Â€ 1ï§ì•·??€?ë¸?ï§??, ?†«?‚†?ƒ½è¹‚Â€??‹”, Sales??’— ?ë¹? 14995676 ?? ™?ë£? ï§ì•·??€?ë§???–

# C_Store??’— ??–?‘œ? ?ê½? åª›ì’–?“½ ?ë£†ç”±?ˆ??€??‹” (C_N_Facs, C_S_Pop, C_W_Pop)åª›Â€ ?€¨ì¢? ™?ë¦??ë¼???—³??“£ ?ë¸??ë¿?, C_Store??“½ æ¹²ê³•?‚¯??–’??åª›Â€ 1ï§ì•·??€?ë¸?ï§??, ?†«?‚†?ƒ½è¹‚Â€??‹”, Sales??’— ?ë¹? 10706604 ?? ™?ë£? ï§ì•·??€?ë§???–

# C_S_Pop??’— ??–?‘œ? ?ê½? åª›ì’–?“½ ?ë£†ç”±?ˆ??€??‹” (C_N_Facs, C_Store, C_W_Pop)åª›Â€ ?€¨ì¢? ™?ë¦??ë¼???—³??“£ ?ë¸??ë¿?, C_S_Pop??“½ æ¹²ê³•?‚¯??–’??åª›Â€ 1ï§ì•·??€?ë¸?ï§??, ?†«?‚†?ƒ½è¹‚Â€??‹”, Sales??’— ?ë¹? 142190 ?? ™?ë£? åª›ë¨¯?ƒ¼?ë§???–

# C_W_Pop??’— ??–?‘œ? ?ê½? åª›ì’–?“½ ?ë£†ç”±?ˆ??€??‹” (C_N_Facs, C_Store, C_S_Pop)åª›Â€ ?€¨ì¢? ™?ë¦??ë¼???—³??“£ ?ë¸??ë¿?, C_W_Pop??“½ æ¹²ê³•?‚¯??–’??åª›Â€ 1ï§ì•·??€?ë¸?ï§??, ?†«?‚†?ƒ½è¹‚Â€??‹”, Sales??’— ?ë¹? 738800 ?? ™?ë£? ï§ì•·??€?ë§???–


# 4??–’?€?? : ?ë£†ç”±?ˆ??€??‹”?ë±???“½ ?ê½•ï§?‚…? °
# Adjusted R-squared:  0.488 
# ?ê½•åª›?’–?“½ ?ë£†ç”±?ˆ??€??‹”åª›Â€ ?†«?‚†?ƒ½è¹‚Â€??‹”?‘œ? ?ë¹? 48.8% ?ê½•ï§?.


# 5.1.3 ï§â‘¤?œ½ å¯ƒÂ€ï§?? ----

# (1) ??–ä»¥ë¬?‚¬?ê½??ê½? ?? å¯ƒÂ€
car::vif(lm.result.final2)

# ï§â‘¤ë±? è¹‚Â€??‹”??“½ vifåª›Â€ 4 èª˜ëªƒì­???” èª˜Â€æ¿?? ??–ä»¥ë¬?‚¬?ê½??ê½????€ è­°ëŒ?˜±?ë¸?ï§Â€ ?ë¸???’— å¯ƒê»‹?‘æ¿?? è¹‚ëŒ?—«.

# (2) ??˜ï§¡â‘¤?…‡?ê½?
gvlma.result <- gvlma::gvlma(lm.result.final2)
summary(gvlma.result)




# ?? ™æ´¹ì’–ê½?, ?ê½???‚?ê½?, ?ë²‘éºê¾©ê¶›?ê½? ï§â‘¤ëª? ?º?ˆì­”è???

lmtest::dwtest(lm.result.final2)

# DW = 2.0244, p-value = 0.6291 , ?ë£†ç”±?Œê½????€ ï§ëš¯?€? 


# 5.2 model2 : ?ê¸½æ²…?š¯?“½ ï§ã…¼?…§?€?? ?ê¸½æ²…?š®ë£†ç”±?ˆ??€??‹”?ë±¾åª›ê¾©ì“½ ??–ä»¥ë¬“?‰¶æ´¹Â€?ºê¾©ê½ ----

total_district_j <- readxl::read_excel("FC_Project1_rawdata/total_district_j.xlsx")
View(total_district_j)

# 5.2.1 è¹‚Â€??‹”?ê½??ê¹? ?€¨ì‡±? ™ ----

lm.result.all      <- lm(total_district_j$d.sales ~ ., data = total_district_j)
lm.result.forward  <- step(lm.result.all, direction = "forward")
lm.result.backward <- step(lm.result.all, direction = "backward")
lm.result.stepwise <- step(lm.result.all, direction = "both")

AIC(lm.result.all)
# 57449.1
AIC(lm.result.forward)
# 57449.1
AIC(lm.result.backward)
# 57443.34
AIC(lm.result.stepwise)
# 57443.34 , stpewise è«›â‘¹?–‡??“£ ï§?ê¾ªê¹®

lm.result.final1 <- lm.result.stepwise
options(scipen = 100) # ?ëª???–†è«›â‘¸ì¾???“£ ??ƒ¼??‹”?? ??‘æ¿??

# 5.2.2 ï§â‘¤?œ½ ?ë¹??ê½? ----

summary(lm.result.final1)
# d.spent??“½ t å¯ƒÂ€?? ™ å¯ƒê³Œ?‚µåª›Â€ 0.05 ???€??“½??‹”ä»¥Â€?ë¿??ê½? ???€??“½?ë¸?ï§Â€ ?ë¸???‘èª˜Â€æ¿?? ï§â‘¤?œ½ ??˜±?´?Šê½¦.

lm.result.final2 <- lm(d.sales ~ d.facility + d.income + d.s.pop + d.w.pop + d.store, data = total_district_j)
summary(lm.result.final2)

# 1??–’?€?? : ??‰¶æ´¹Â€ï§â‘¦?‚???€ ???€??–¦?ë¸³åª›?€?
# F-statistic: 298.7 on 5 and 1270 DF,  p-value: < 0.00000000000000022
# å¯ƒê³•ì¤? : ???€??“½??†—?‘œì¢ì”  0.000 ??” èª˜Â€æ¿?? ???€??“½??‹”ä»¥Â€ 0.05?ë¿??ê½? ??‰¶æ´¹Â€ï§â‘¦?‚???€ ??„»?€¨ê¾©?Ÿ»??‘æ¿?? ???€??–¦?ë¸???–.

# 2??–’?€?? : ?ë£†ç”±?ˆ??€??‹”?ë±???”  ?†«?‚†?ƒ½è¹‚Â€??‹”?ë¿‰å¯ƒ? ??º?ë¼???“£ äºŒì‡°?’—åª›Â€?
# #                 Estimate   Std. Error t value             Pr(>|t|)    
# (Intercept) -383578577.3    176436461.3  -2.174               0.0299 *  
#   d.facility    13576875.0    2039343.0   6.657      0.0000000000413 ***
#   d.income           120.1         54.8   2.192               0.0285 *  
#   d.s.pop        -128959.3      31004.3  -4.159      0.0000340527132 ***
#   d.w.pop         740052.3      33821.7  21.881 < 0.0000000000000002 ***
#   d.store       10889230.2     899265.4  12.109 < 0.0000000000000002 ***   

# å¯ƒê³•ì¤? : d.facility (t = 6.657,  p < 0.001)
#        d.income   (t = 2.192,  p < 0.05)
#        d.s.pop    (t = -4.159, p < 0.001)
#        d.w.pop    (t = 21.881, p < 0.001)
#        d.store    (t = 12.109,  p < 0.001)
# ?ë£†ç”±?ˆ??€??‹” 5åª?? ï§â‘¤ëª¢åª›?€ ?†«?‚†?ƒ½è¹‚Â€??‹”?ë¿‰å¯ƒ? ???€??“½??‹”ä»¥Â€ 0.05?ë¿??ê½? ??„»?€¨ê¾©?Ÿ»??‘æ¿?? ???€??“½?ë¸? ??º?ë¼???“£ äºŒì‡°?’— å¯ƒê»‹?‘æ¿?? ?êµ????€?ê¶???–.

# 3??–’?€?? : ?ë£†ç”±?ˆ??€??‹”?ë±????€ ?ë¼??ë¼? ??º?ë¼???“£ äºŒì‡°?’—åª›Â€?
#                  Estimate   
# (Intercept)   -383578577.3  
#   d.facility    13576875.0   
#   d.income           120.1       
#   d.s.pop        -128959.3      
#   d.w.pop         740052.3      
#   d.store       10889230.2     

# 4??–’?€?? : ?ë£†ç”±?ˆ??€??‹”?ë±???“½ ?ê½•ï§?‚…? °
# Adjusted R-squared:  0.5386
# ?ê½•åª›?’–?“½ ?ë£†ç”±?ˆ??€??‹”åª›Â€ ?†«?‚†?ƒ½è¹‚Â€??‹”?‘œ? ?ë¹? 53.86% ?ê½•ï§?.

# model 1 è¹‚ë?€?– model2 ??“½ ?ê½•ï§?‚…? °??”  ??„‚??‘èª˜Â€æ¿??, ??½??˜±æºëš¯??€??’— model2åª›Â€ åª›Â€??˜£ ???€??Šš?ë¹è¹‚?Œ?—«.

# 5.2.3 ï§â‘¤?œ½ å¯ƒÂ€ï§?? ----

# (1) ??–ä»¥ë¬?‚¬?ê½??ê½? ?? å¯ƒÂ€
car::vif(lm.result.final2)

# ï§â‘¤ë±? è¹‚Â€??‹”??“½ vifåª›Â€ 4 èª˜ëªƒì­???” èª˜Â€æ¿?? ??–ä»¥ë¬?‚¬?ê½??ê½????€ è­°ëŒ?˜±?ë¸?ï§Â€ ?ë¸???’— å¯ƒê»‹?‘æ¿?? è¹‚ëŒ?—«.

# (2) ??˜ï§¡â‘¤?…‡?ê½?
gvlma.result <- gvlma::gvlma(lm.result.final2)
summary(gvlma.result)

# Call:
#   gvlma::gvlma(x = lm.result.final2) 
# 
#                       Value        p-value    Decision
#   Global Stat         2960417.83   0          Assumptions NOT satisfied!
#   Skewness            19869.84     0          Assumptions NOT satisfied!
#   Kurtosis            2940335.11   0          Assumptions NOT satisfied!
#   Link Function       140.36       0          Assumptions NOT satisfied!
#   Heteroscedasticity  72.52        0          Assumptions NOT satisfied!

# ?? ™æ´¹ì’–ê½?, ?ê½???‚?ê½?, ?ë²‘éºê¾©ê¶›?ê½? ï§â‘¤ëª? ?º?ˆì­”è???

lmtest::dwtest(lm.result.final2)

# DW = 1.9866, p-value = 0.4057 
# DW test å¯ƒê³Œ?‚µ?ê¸? ?ë£†ç”±?Œê½????€ ï§ëš¯?€? 


# 6. model2 ??“½ ï§â‘¤?œ½ ???€??Šš?ê½? ?‡¾ëª„ì £ åª›ì’–ê½? ----


